# React

## hooks

1. 为什么会出现 hooks

   hooks 出现是为了解决函数式组件没有状态的问题、组件之间的逻辑状态难以复用（从 mixin 到 hoc）、大型复杂组件很难拆分、Class 组件的语法不友好

2. useEffect 如何被触发

   ```js
   // 1. 当不传入依赖时
   // 组件挂载完成之后执行 && 组件数据更新完成之后执行``;
   // 2. 当依赖传入空数组时
   // 组件挂载完成之后执行
   // 3. 当传入变量state 或者 props 时
   // 当变量发生变化时
   ```

3. 模拟 useState

   为保证 hook 的执行顺序，React 内部使用链表结构来保存 hooks，所以不能在条件中定义 hooks

   ```js
   import React from 'react';
   // 导入dom,用于更新组件
   import ReactDom from 'react-dom';

   let state;
   function useState(initState) {
     // 判断state 是否是初始化
     state = state ? state : initState;
     function setState(newState) {
       // 更新数据
       state = newState;
       // 调用函数，更新组件
       render();
     }

     return [state, setState];
   }

   // 重新渲染组件
   function render() {
     ReactDom.render(<App />, document.getElementById('root'));
   }

   function App() {
     // 使用自定义 useState
     const [count, setCount] = useState(1);

     return (
       <div>
         <p>{count}</p>
         <button onClick={() => setCount(count + 1)}>加1</button>
       </div>
     );
   }

   export default App;
   ```
